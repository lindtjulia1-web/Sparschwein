<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <style>
        :root {
            --gold: #f9e076;
            --gold-gradient: linear-gradient(to top, #bf953f, #fcf6ba, #b38728, #fbf5b7, #aa771c);
            --glass-stroke: rgba(255, 255, 255, 0.25);
        }
        body { background: #0a0a0a; margin: 0; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }

        .game-card {
            width: 380px; background: #111; border-radius: 45px; padding: 35px;
            text-align: center; border: 1px solid #222; box-shadow: 0 40px 120px rgba(0,0,0,0.9);
            position: relative; z-index: 10;
        }

        .lang-switch { position: absolute; top: 25px; right: 35px; display: flex; gap: 8px; z-index: 20; }
        .lang-btn {
            background: #1a1a1a; border: 1px solid #333; color: #555;
            font-size: 10px; padding: 4px 10px; cursor: pointer; border-radius: 6px; transition: 0.3s;
        }
        .lang-btn.active { border-color: var(--gold); color: var(--gold); background: #221e0a; }

        .pig-container {
            position: relative; width: 300px; height: 220px; margin: 0 auto;
            transition: transform 0.1s ease-in-out;
        }

        /* Анимация тряски при попадании */
        .shake { animation: pigShake 0.4s ease-in-out; }
        @keyframes pigShake {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.05) rotate(2deg); }
            50% { transform: scale(0.95) rotate(-2deg); }
            75% { transform: scale(1.02) rotate(1deg); }
        }

        .sand-mask {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            clip-path: path('M160,55 C240,55 280,85 280,120 C280,155 235,185 160,185 C85,185 40,155 40,120 C40,85 80,55 160,55 Z');
            z-index: 1;
        }

        .sand-fill {
            position: absolute; bottom: 35px; left: 0; width: 100%; height: 0%;
            background: var(--gold-gradient); transition: height 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            background-size: 200% 200%;
            animation: sandShimmer 3s infinite alternate;
        }

        @keyframes sandShimmer {
            from { background-position: 0% 0%; }
            to { background-position: 100% 100%; }
        }

        .pig-svg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2; fill: none; stroke: var(--glass-stroke); stroke-width: 1.2;
        }

        .glass-glint {
            stroke: rgba(255, 255, 255, 0.5);
            stroke-dasharray: 80 1000;
            stroke-dashoffset: 1000;
            animation: glintMove 6s infinite linear;
        }

        @keyframes glintMove {
            0% { stroke-dashoffset: 1000; }
            20% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: 0; }
        }

        .score { font-size: 58px; color: var(--gold); font-weight: bold; margin: 5px 0 0; text-shadow: 0 0 25px rgba(249, 224, 118, 0.2); }
        .q-text { min-height: 50px; font-size: 19px; margin: 10px 0 25px; color: #ddd; font-weight: 300; }
        
        .btn-group { display: flex; justify-content: center; gap: 12px; }
        .btn {
            background: transparent; border: 1px solid var(--gold); color: var(--gold);
            padding: 12px 28px; border-radius: 18px; cursor: pointer; font-weight: bold; transition: 0.3s;
            position: relative; overflow: hidden;
        }
        .btn:hover { background: var(--gold); color: #000; box-shadow: 0 0 25px rgba(249, 224, 118, 0.4); }
        .btn-ans { border-color: #444; color: #fff; }

        .feedback { font-size: 14px; font-weight: bold; margin-bottom: 10px; min-height: 20px; text-transform: uppercase; letter-spacing: 2px; }
        .hidden { display: none; }

        /* Конфетти */
        .confetti {
            position: absolute; width: 8px; height: 8px; background: var(--gold);
            border-radius: 2px; pointer-events: none; z-index: 100;
        }
    </style>
</head>
<body>

<div class="game-card">
    <div class="lang-switch">
        <button class="lang-btn active" onclick="setLang('ru', this)">RU</button>
        <button class="lang-btn" onclick="setLang('en', this)">EN</button>
        <button class="lang-btn" onclick="setLang('de', this)">DE</button>
    </div>

    <div class="pig-container" id="pig-box">
        <div class="sand-mask"><div id="sand" class="sand-fill"></div></div>
        
        <svg class="pig-svg" viewBox="0 0 320 220">
            <path id="mainPath" d="M160,55 C240,55 280,85 280,120 C280,155 235,185 160,185 C85,185 40,155 40,120 C40,85 80,55 160,55" />
            <path class="glass-glint" d="M160,55 C240,55 280,85 280,120 C280,155 235,185 160,185 C85,185 40,155 40,120 C40,85 80,55 160,55" stroke-width="2" />
            <ellipse cx="160" cy="55" rx="25" ry="3" />
            <path d="M100,185 C95,205 110,210 120,205 C125,200 125,185 125,185" />
            <path d="M200,185 C195,205 210,210 220,205 C225,200 225,185 225,185" />
            <path d="M280,110 L295,110 M280,132 L295,132" />
            <ellipse cx="295" cy="121" rx="4" ry="11" />
            <path d="M235,70 C245,45 270,45 275,80 C260,85 240,80 235,70" />
            <path d="M195,60 C205,35 225,40 230,65" />
            <path d="M40,110 C15,100 10,75 30,75 C45,75 40,95 30,90" />
            <path d="M100,90 Q160,70 220,100" stroke="white" stroke-opacity="0.1" stroke-width="4" />
        </svg>
    </div>

    <div class="score" id="total-val">0</div>
    <div class="q-text" id="question"></div>

    <div id="bet-screen">
        <div class="btn-group">
            <button class="btn" onclick="startStage(10)">10</button>
            <button class="btn" onclick="startStage(25)">25</button>
            <button class="btn" onclick="startStage(50)">50</button>
        </div>
    </div>

    <div id="ans-screen" class="hidden">
        <div class="btn-group" id="ans-list"></div>
    </div>

    <div id="res-screen" class="hidden">
        <div id="res-msg" class="feedback"></div>
        <button class="btn" id="next-btn" onclick="nextQuestion()"></button>
    </div>
</div>

<script>
    let totalScore = 0;
    let currentBet = 0;
    let qIdx = 0;
    let curLang = 'ru';
    const MAX_POINTS = 500;

    const i18n = {
        ru: { nextBtn: "ДАЛЕЕ", correct: "ВЕРНО!", wrong: "ОШИБКА!", questions: [{q: "Emil ... gefrühstückt.", a:["hat","ist"], c:0}, {q:"Wir ... im Kino.", a:["haben","sind"], c:1}] },
        en: { nextBtn: "NEXT", correct: "CORRECT!", wrong: "WRONG!", questions: [{q: "Emil ... had breakfast.", a:["hat","ist"], c:0}, {q:"We ... at the cinema.", a:["haben","sind"], c:1}] },
        de: { nextBtn: "WEITER", correct: "RICHTIG!", wrong: "FALSCH!", questions: [{q: "Emil ... gefrühstückt.", a:["hat","ist"], c:0}, {q:"Wir ... im Kino.", a:["haben","sind"], c:1}] }
    };

    function createConfetti(amount) {
        for(let i=0; i<amount; i++) {
            const c = document.createElement('div');
            c.className = 'confetti';
            document.body.appendChild(c);
            
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight / 2 - 50;
            const angle = Math.random() * Math.PI * 2;
            const velocity = 5 + Math.random() * 10;
            const tx = Math.cos(angle) * velocity * 20;
            const ty = Math.sin(angle) * velocity * 20;

            c.style.left = startX + 'px';
            c.style.top = startY + 'px';
            c.style.background = `hsl(${45 + Math.random()*15}, 100%, ${50 + Math.random()*20}%)`;

            const anim = c.animate([
                { transform: 'translate(0,0) rotate(0)', opacity: 1 },
                { transform: `translate(${tx}px, ${ty}px) rotate(${Math.random()*720}deg)`, opacity: 0 }
            ], { duration: 1000 + Math.random()*1000, easing: 'cubic-bezier(0, .5, .5, 1)' });

            anim.onfinish = () => c.remove();
        }
    }

    function setLang(lang, btn) {
        curLang = lang;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        updateUI();
    }

    function startStage(val) {
        currentBet = val;
        document.getElementById('bet-screen').classList.add('hidden');
        const list = document.getElementById('ans-list');
        list.innerHTML = '';
        i18n[curLang].questions[qIdx].a.forEach((text, i) => {
            list.innerHTML += `<button class="btn btn-ans" onclick="finishStage(${i})">${text}</button>`;
        });
        document.getElementById('ans-screen').classList.remove('hidden');
    }

    function finishStage(idx) {
        const isWin = idx === i18n[curLang].questions[qIdx].c;
        const msg = document.getElementById('res-msg');
        const pig = document.getElementById('pig-box');

        if(isWin) { 
            totalScore += currentBet; 
            msg.innerText = i18n[curLang].correct; 
            msg.style.color = "#4caf50";
            pig.classList.add('shake');
            setTimeout(() => pig.classList.remove('shake'), 400);
            createConfetti(totalScore >= MAX_POINTS ? 100 : 20);
        } else { 
            totalScore = Math.max(0, totalScore - currentBet); 
            msg.innerText = i18n[curLang].wrong; 
            msg.style.color = "#ff5252"; 
        }
        
        updateSand();
        document.getElementById('total-val').innerText = totalScore;
        document.getElementById('ans-screen').classList.add('hidden');
        document.getElementById('res-screen').classList.remove('hidden');
    }

    function updateUI() {
        document.getElementById('question').innerText = i18n[curLang].questions[qIdx].q;
        document.getElementById('next-btn').innerText = i18n[curLang].nextBtn;
        document.getElementById('total-val').innerText = totalScore;
        updateSand();
    }

    function updateSand() {
        let h = Math.min(60, (totalScore / MAX_POINTS) * 60);
        document.getElementById('sand').style.height = h + '%';
    }

    function nextQuestion() {
        qIdx = (qIdx + 1) % i18n[curLang].questions.length;
        document.getElementById('res-screen').classList.add('hidden');
        document.getElementById('bet-screen').classList.remove('hidden');
        updateUI();
    }
    updateUI();
</script>
</body>
</html>

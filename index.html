<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>KGB Sparschwein Editor PRO</title>
    <style>
        :root { --accent: #f9e076; --bg: #0e0e10; --panel: #18181b; --border: #2d2d33; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Sidebar */
        .sidebar { width: 360px; background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 10; }
        .sidebar-content { flex: 1; overflow-y: auto; padding: 20px; }
        h2 { color: var(--accent); font-size: 14px; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 20px; }
        
        /* Размерная сетка */
        .size-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .preset-btns { display: flex; gap: 5px; margin-bottom: 20px; }
        .btn-mini { background: #333; border: none; color: #aaa; font-size: 10px; padding: 5px 8px; border-radius: 4px; cursor: pointer; flex: 1; }
        .btn-mini:hover { background: #444; color: #fff; }

        .card { background: #222; border: 1px solid #333; padding: 15px; border-radius: 10px; margin-bottom: 10px; position: relative; }
        .del-btn { position: absolute; top: 8px; right: 8px; color: #ff4444; font-size: 18px; cursor: pointer; }
        
        label { display: block; font-size: 10px; color: #888; text-transform: uppercase; margin-top: 8px; font-weight: bold; }
        input, select { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 8px; border-radius: 6px; margin-top: 4px; box-sizing: border-box; outline: none; }

        .btn { background: #333; color: #fff; border: none; padding: 12px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .btn-main { background: var(--accent); color: #000; margin-top: 20px; text-transform: uppercase; }

        /* Preview Area */
        .preview { flex: 1; background: #000; display: flex; align-items: center; justify-content: center; overflow: auto; padding: 40px; }
        #device { border: 10px solid #222; border-radius: 40px; overflow: hidden; background: #111; box-shadow: 0 0 50px rgba(0,0,0,0.5); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        iframe { width: 100%; height: 100%; border: none; }
        
        #code-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 100; flex-direction: column; }
        textarea { width: 80%; max-width: 700px; height: 350px; background: #111; color: var(--accent); padding: 20px; border: 1px solid var(--accent); border-radius: 12px; font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="sidebar-content">
        <h2>Настройки Размера</h2>
        
        <div class="size-grid">
            <div><label>Ширина (px)</label><input type="number" id="width" value="380" oninput="resizePreview()"></div>
            <div><label>Высота (px)</label><input type="number" id="height" value="640" oninput="resizePreview()"></div>
        </div>
        <div class="preset-btns">
            <button class="btn-mini" onclick="setPreset(380, 640)">Смартфон</button>
            <button class="btn-mini" onclick="setPreset(500, 500)">Квадрат</button>
            <button class="btn-mini" onclick="setPreset(800, 600)">Планшет</button>
        </div>

        <h2>Контент</h2>
        <label>Фон (URL)</label>
        <input type="text" id="bg-url" value="" placeholder="https://...">

        <div id="q-container"></div>
        <button class="btn" onclick="addQ()">+ Добавить вопрос</button>

        <label>Цель (очков)</label>
        <input type="number" id="goal" value="500">
        
        <label>Язык</label>
        <select id="lang">
            <option value="ru">Русский</option>
            <option value="en">English</option>
            <option value="de">Deutsch</option>
        </select>
    </div>
    <div style="padding: 20px; border-top: 1px solid #333;">
        <button class="btn btn-main" onclick="updatePreview()">Обновить Превью</button>
        <button class="btn" onclick="getGeniallyCode()" style="background:#00d4ff; color:#000">ПОЛУЧИТЬ КОД ДЛЯ GENIALLY</button>
    </div>
</div>

<div class="preview">
    <div id="device"><iframe id="ifr"></iframe></div>
</div>

<div id="code-modal">
    <h3 style="color: #fff">Код готов! Вставьте его в Genially:</h3>
    <textarea id="result-code" readonly onclick="this.select()"></textarea>
    <button class="btn" onclick="document.getElementById('code-modal').style.display='none'" style="width: 200px">Закрыть</button>
</div>

<script>
// --- ФУНКЦИИ РЕГУЛИРОВКИ РАЗМЕРА (То, что просили изменить) ---
function resizePreview() {
    const w = document.getElementById('width').value;
    const h = document.getElementById('height').value;
    const device = document.getElementById('device');
    if(w > 0) device.style.width = w + "px";
    if(h > 0) device.style.height = h + "px";
}

function setPreset(w, h) {
    document.getElementById('width').value = w;
    document.getElementById('height').value = h;
    resizePreview();
}

// --- ОСТАЛЬНАЯ ЛОГИКА (БЕЗ ИЗМЕНЕНИЙ) ---
function addQ(qText = "", answers = ["", "", "", ""]) {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `<span class="del-btn" onclick="this.parentElement.remove()">×</span><label>Вопрос</label><input type="text" class="inp-q" value="${qText}"><label>Ответы (Первый - верный)</label><input type="text" class="inp-a" value="${answers.join(', ')}">`;
    document.getElementById('q-container').appendChild(div);
}

function buildInnerGame() {
    const qs = [];
    document.querySelectorAll('.card').forEach(card => {
        const q = card.querySelector('.inp-q').value;
        const aRaw = card.querySelector('.inp-a').value;
        if(q && aRaw) qs.push({ q: q, a: aRaw.split(',').map(s => s.trim()) });
    });
    const config = { bg: document.getElementById('bg-url').value, goal: document.getElementById('goal').value, lang: document.getElementById('lang').value, data: qs };

    return `<!DOCTYPE html><html><head><meta charset="UTF-8"><style>:root{--gold:#f9e076;--gold-d:#bf953f}body{margin:0;height:100vh;overflow:hidden;font-family:sans-serif;background:#000;color:#fff;display:flex;align-items:center;justify-content:center}.bg{position:fixed;inset:0;background:url('${config.bg}') center/cover;opacity:0.6;z-index:-1}.card{width:320px;background:rgba(20,20,25,0.95);border-radius:35px;padding:25px;border:1px solid #333;text-align:center;box-shadow:0 20px 50px #000}.pig{width:280px;height:180px;margin:0 auto 10px;position:relative}#sand{transition:all 1s ease}.score{font-size:40px;color:var(--gold);font-weight:800;margin:5px 0}.q-box{min-height:60px;font-size:18px;margin-bottom:15px;display:flex;align-items:center;justify-content:center}.grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}.btn{border:1px solid #444;background:#1a1a1a;color:#ccc;padding:12px;border-radius:12px;cursor:pointer;font-weight:bold}.btn-bet{color:var(--gold);border-color:#554}.btn-ans{width:100%;margin-bottom:8px;border:1px solid var(--gold);color:var(--gold);background:none}.grain{position:absolute;width:3px;height:3px;background:var(--gold);border-radius:50%;pointer-events:none}</style></head><body><div class="bg"></div><div class="card"><div class="pig" id="p"><svg viewBox="0 0 320 220"><defs><mask id="m"><path d="M60,110 C60,70 110,50 170,50 C250,50 290,80 290,125 C290,165 240,190 170,190 C100,190 60,160 60,110" fill="white"/></mask><linearGradient id="g" x1="0" y1="1" x2="0" y2="0"><stop offset="0%" stop-color="var(--gold-d)"/><stop offset="100%" stop-color="var(--gold)"/></linearGradient></defs><g mask="url(#m)"><rect id="sand" x="50" y="190" width="250" height="0" fill="url(#g)"/></g><path d="M60,110 C60,70 110,50 170,50 C250,50 290,80 290,125 C290,165 240,190 170,190 C100,190 60,160 60,110" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="2"/></svg></div><div class="score" id="s">0</div><div class="q-box" id="qt"></div><div id="ctrl"></div></div><script>const cfg=JSON.parse(decodeURIComponent("${encodeURIComponent(JSON.stringify(config))}"));let sc=0,qi=0,bt=0;function init(){if(qi>=cfg.data.length){document.getElementById('qt').innerText="FINISH";return}document.getElementById('qt').innerText=cfg.data[qi].q;const c=document.getElementById('ctrl');c.innerHTML='<div class="grid"></div>';[10,25,50,100].forEach(v=>{const b=document.createElement('button');b.className='btn btn-bet';b.innerText=v;b.onclick=()=>{bt=v;showA()};c.querySelector('.grid').appendChild(b)})};function showA(){const c=document.getElementById('ctrl');c.innerHTML='';[...cfg.data[qi].a].sort(()=>Math.random()-.5).forEach(o=>{const b=document.createElement('button');b.className='btn btn-ans';b.innerText=o;b.onclick=()=>{if(o===cfg.data[qi].a[0]){sc=Math.min(cfg.goal,sc+bt);drop()}else{sc=Math.max(0,sc-bt)}upd();qi++;setTimeout(init,1000)};c.appendChild(b)})};function upd(){document.getElementById('s').innerText=sc;const h=(sc/cfg.goal)*140;const r=document.getElementById('sand');r.setAttribute('height',h);r.setAttribute('y',190-h)};function drop(){for(let i=0;i<15;i++){const g=document.createElement('div');g.className='grain';g.style.left=(130+Math.random()*60)+'px';g.style.top='40px';document.getElementById('p').appendChild(g);g.animate([{transform:'translateY(0)'},{transform:'translateY(120px)',opacity:0}],800).onfinish=()=>g.remove()}}init();<\/script></body></html>`;
}

function updatePreview() {
    resizePreview();
    document.getElementById('ifr').srcdoc = buildInnerGame();
}

function getGeniallyCode() {
    const w = document.getElementById('width').value;
    const h = document.getElementById('height').value;
    const innerHTML = buildInnerGame().replace(/"/g, '&quot;');
    const iframeCode = `<iframe width="${w}" height="${h}" srcdoc="${innerHTML}" frameborder="0" scrolling="no" style="border:none; overflow:hidden;"></iframe>`;
    document.getElementById('result-code').value = iframeCode;
    document.getElementById('code-modal').style.display = 'flex';
}

window.onload = () => { addQ("Ich ... (haben) ein Auto", ["habe", "hast", "hat", "haben"]); updatePreview(); };
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <style>
        :root { --gold: #ffcc00; --bg: #121212; --panel: #1e1e1e; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Панель настроек (Admin) */
        .admin-panel { 
            width: 380px; background: var(--panel); overflow-y: auto; padding: 20px; 
            border-right: 1px solid #333; box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }
        h2 { color: var(--gold); font-size: 1.2rem; margin-top: 0; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .setting-item { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; color: #aaa; margin-bottom: 5px; }
        input, select, textarea { 
            width: 100%; background: #2a2a2a; border: 1px solid #444; color: white; 
            padding: 10px; border-radius: 8px; box-sizing: border-box;
        }
        textarea { resize: vertical; }

        /* Область превью */
        .preview-area { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #080808; position: relative; }
        .preview-label { position: absolute; top: 20px; color: #444; font-weight: bold; letter-spacing: 2px; }

        /* Виджет в стиле макета */
        .widget { 
            width: 400px; background: #151515; border-radius: 25px; padding: 30px; 
            text-align: center; border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,0,0,1);
        }
        .pig-frame {
            position: relative; width: 280px; height: 180px; margin: 0 auto 20px;
            display: flex; align-items: flex-end; justify-content: center;
        }
        #pig-img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: contain; z-index: 2; pointer-events: none;
        }
        .sand-layer { 
            width: 170px; height: 35%; background: linear-gradient(to top, #bf953f, #fcf6ba, #b38728);
            border-radius: 0 0 70px 70px; margin-bottom: 25px; transition: 1s ease-in-out; opacity: 0.85; z-index: 1;
        }
        .bank-text { color: var(--gold); font-size: 24px; margin-bottom: 15px; font-weight: bold; }
        .bet-row { display: flex; justify-content: center; gap: 10px; }
        .bet-item { 
            width: 65px; height: 50px; border: 2px solid var(--gold); border-radius: 12px;
            display: flex; align-items: center; justify-content: center; color: var(--gold); font-weight: bold;
        }

        .code-btn {
            width: 100%; background: var(--gold); color: black; border: none; padding: 15px;
            border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s;
        }
        .code-btn:hover { background: #e6b800; transform: translateY(-2px); }
    </style>
</head>
<body>

<div class="admin-panel">
    <h2>⚙️ Конструктор игры</h2>
    
    <div class="setting-item">
        <label>Изображение копилки (URL-ссылка)</label>
        <input type="text" id="cfg-img" value="https://i.ibb.co/3Y8M4v8/glass-pig-template.png" oninput="updatePreview()">
    </div>

    <div class="setting-item">
        <label>Задания (Вопрос | Отметы через запятую | Индекс верного)</label>
        <textarea id="cfg-questions" rows="4">Er... Sport|hat gemacht,ist gemacht|0</textarea>
    </div>

    <div class="setting-item">
        <label>Монеты для ставок (через запятую)</label>
        <input type="text" id="cfg-bets" value="10, 25, 50" oninput="updatePreview()">
    </div>

    <div class="setting-item">
        <label>Язык интерфейса</label>
        <select id="cfg-lang">
            <option value="ru">Русский</option>
            <option value="de">Deutsch</option>
            <option value="en">English</option>
        </select>
    </div>

    <div class="setting-item">
        <label>Режим штрафов</label>
        <select id="cfg-penalty">
            <option value="true">Штраф включен (Риск)</option>
            <option value="false">Штраф выключен (Обучение)</option>
        </select>
    </div>

    <div class="setting-item">
        <label>Цель (размер копилки)</label>
        <input type="number" id="cfg-target" value="200">
    </div>

    <button class="code-btn" onclick="copyGeniallyCode()">СКОПИРОВАТЬ КОД ДЛЯ GENIALLY</button>
</div>

<div class="preview-area">
    <div class="preview-label">LIVE PREVIEW</div>
    <div class="widget">
        <div class="pig-frame">
            <img id="pig-img" src="https://i.ibb.co/3Y8M4v8/glass-pig-template.png" alt="pig">
            <div id="preview-sand" class="sand-layer"></div>
        </div>
        <div class="bank-text">Всего: <span id="preview-score">0</span></div>
        <div class="bet-row" id="preview-bets-box">
            </div>
    </div>
</div>

<script>
    function updatePreview() {
        // Обновляем картинку
        const imgUrl = document.getElementById('cfg-img').value;
        document.getElementById('pig-img').src = imgUrl;

        // Обновляем кнопки ставок
        const bets = document.getElementById('cfg-bets').value.split(',');
        const box = document.getElementById('preview-bets-box');
        box.innerHTML = '';
        bets.forEach(b => {
            box.innerHTML += `<div class="bet-item">${b.trim()}</div>`;
        });
    }

    function copyGeniallyCode() {
        const config = {
            img: document.getElementById('cfg-img').value,
            questions: document.getElementById('cfg-questions').value,
            bets: document.getElementById('cfg-bets').value,
            lang: document.getElementById('cfg-lang').value,
            penalty: document.getElementById('cfg-penalty').value,
            target: document.getElementById('cfg-target').value
        };

        const embedCode = `<div id="confidence-game-container"></div>
<script src="https://cdn.jsdelivr.net/gh/your-repo/player.js"><\/script>
<script>
    initConfidenceGame(${JSON.stringify(config)});
<\/script>`;
        
        navigator.clipboard.writeText(embedCode);
        alert("Код скопирован! Вставьте его в Genially через 'Insert' -> 'Others'.");
    }

    updatePreview();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>KGB Pile Editor Pro + Piggy</title>

<style>
:root{
  --accent:#f9e076;
  --bg:#1e1e24;
  --panel:#2a2a32;
  --border:#3d3d45;
  --green:#4caf50;
  --red:#f44336;
}

body{
  margin:0;
  height:100vh;
  display:flex;
  background:#000;
  color:#fff;
  font-family:'Segoe UI',sans-serif;
  overflow:hidden;
}

/* ===== SIDEBAR (НЕ МЕНЯЛА) ===== */
.sidebar{
  width:380px;
  background:var(--panel);
  border-right:1px solid var(--border);
  display:flex;
  flex-direction:column;
}
.sidebar-content{
  flex:1;
  overflow-y:auto;
  padding:25px;
}
h2{
  color:var(--accent);
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:1.5px;
  margin:25px 0 10px;
  border-left:3px solid var(--accent);
  padding-left:10px;
}
label{
  display:block;
  font-size:10px;
  color:#aaa;
  text-transform:uppercase;
  margin-top:8px;
}
input,select{
  width:100%;
  background:#111;
  border:1px solid #444;
  color:#fff;
  padding:10px;
  border-radius:12px;
  margin-top:5px;
}
.btn{
  background:#3d3d45;
  border:none;
  padding:14px;
  border-radius:15px;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
.btn-main{
  background:#ffb347;
  color:#000;
  margin-top:15px;
}
.btn-code{
  background:#77dd77;
  color:#000;
  margin-top:8px;
}

/* ===== PREVIEW ===== */
.preview{
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#0c0c0e;
}
#device-wrapper{
  position:relative;
  overflow:hidden;
  border-radius:30px;
}
iframe{
  width:100%;
  height:100%;
  border:none;
}

/* ===== GAME ===== */
@keyframes coinFall{
  from{transform:translateY(-100px) scale(.8);opacity:0}
  to{transform:translateY(var(--fall-y)) scale(1);opacity:1}
}

@keyframes shine{
  0%,100%{filter:brightness(1)}
  50%{filter:brightness(1.3)}
}

</style>
</head>

<body>

<div class="sidebar">
  <div class="sidebar-content">
    <h2>Запуск</h2>
    <label>Заголовок</label>
    <input id="start-title" value="Готовы к игре?">
    <label>Кнопка</label>
    <input id="start-btn-text" value="НАЧАТЬ">

    <h2>Финал</h2>
    <label>Текст</label>
    <input id="end-text">

    <h2>Свинка</h2>
    <label>Цвет контура</label>
    <input type="color" id="pigColor" value="#ffffff">
    <label>Толщина</label>
    <input type="number" id="pigStroke" value="3">

    <h2>Размер</h2>
    <input id="width" value="400">
    <input id="height" value="600">
  </div>

  <div style="padding:20px">
    <button class="btn btn-main" onclick="updatePreview()">ОБНОВИТЬ</button>
    <button class="btn btn-code" onclick="getCode()">КОД</button>
  </div>
</div>

<div class="preview">
  <div id="device-wrapper">
    <iframe id="ifr"></iframe>
  </div>
</div>

<script>
function buildGame(){
return `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
body{
 margin:0;
 background:#000;
 color:#fff;
 display:flex;
 align-items:center;
 justify-content:center;
 height:100vh;
 font-family:Segoe UI;
}

#game{
 width:100%;
 height:100%;
 position:relative;
 display:flex;
 flex-direction:column;
}

.score{
 text-align:center;
 font-size:42px;
 font-weight:800;
 color:#f9e076;
}

#pile{
 flex:1;
 position:relative;
 display:flex;
 align-items:center;
 justify-content:center;
 overflow:hidden;
}

.coin{
 position:absolute;
 width:48px;
 height:48px;
 pointer-events:none;
 animation:coinFall 1s ease forwards;
}

.coin::before{
 content:'';
 width:100%;
 height:100%;
 border-radius:50%;
 background:radial-gradient(circle at 30% 30%,#fff,#ffd95a,#a97c1a);
 display:block;
 box-shadow:0 6px 18px rgba(0,0,0,.6);
}

@keyframes coinFall{
 from{transform:translateY(-80px)}
 to{transform:translateY(var(--fall-y))}
}

.coins-inside{
 position:absolute;
 bottom:78px;
 left:50%;
 transform:translateX(-50%);
 width:120px;
 height:55px;
 display:flex;
 flex-wrap:wrap;
 justify-content:center;
 overflow:hidden;
 pointer-events:none;
}
.stored{
 width:20px;
 height:20px;
 border-radius:50%;
 background:radial-gradient(circle,#ffd95a,#a97c1a);
 margin:1px;
}

</style>
</head>

<body>
<div id="game">
  <div class="score" id="score">0</div>
  <div id="pile">

<svg width="260" height="200" viewBox="0 0 260 200">
  <ellipse cx="130" cy="115" rx="90" ry="60"
    fill="rgba(255,255,255,.05)"
    stroke="${document.getElementById('pigColor').value}"
    stroke-width="${document.getElementById('pigStroke').value}"/>
  <ellipse cx="185" cy="90" rx="40" ry="34"
    fill="none"
    stroke="${document.getElementById('pigColor').value}"
    stroke-width="${document.getElementById('pigStroke').value}"/>
  <rect x="110" y="70" width="40" height="6" rx="3"
    fill="none"
    stroke="${document.getElementById('pigColor').value}"
    stroke-width="${document.getElementById('pigStroke').value}"/>
</svg>

<div class="coins-inside" id="inside"></div>

</div>
</div>

<script>
let score=0;
let slot={x:130,y:80};

function drop(n){
 const pile=document.getElementById('pile');
 for(let i=0;i<n;i++){
  setTimeout(()=>{
   const c=document.createElement('div');
   c.className='coin';
   c.style.left=(slot.x-20+Math.random()*40)+'px';
   c.style.setProperty('--fall-y',(slot.y+10)+'px');
   pile.appendChild(c);
   setTimeout(()=>{
    c.remove();
    store();
   },1000);
  },i*180);
 }
}

function store(){
 const i=document.getElementById('inside');
 const c=document.createElement('div');
 c.className='stored';
 i.appendChild(c);
}

drop(10);
<\/script>

</body>
</html>`;
}

function updatePreview(){
 const w=document.getElementById('width').value;
 const h=document.getElementById('height').value;
 const d=document.getElementById('device-wrapper');
 d.style.width=w+'px';
 d.style.height=h+'px';
 document.getElementById('ifr').srcdoc=buildGame();
}

function getCode(){
 alert('iframe готов');
}

updatePreview();
</script>

</body>
</html>

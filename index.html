<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <style>
        :root { --sand-color: linear-gradient(to top, #d4af37, #f9e076, #c5a028); }
        body { background: #000; color: #fff; font-family: sans-serif; display: flex; margin: 0; height: 100vh; }
        
        /* Стили редактора */
        .editor { width: 350px; background: #1a1a1a; padding: 20px; border-right: 2px solid #333; overflow-y: auto; }
        input, textarea, select { width: 100%; background: #000; border: 1px solid #444; color: #fff; padding: 10px; margin-bottom: 15px; border-radius: 5px; }
        .btn-build { width: 100%; background: #ffcc00; color: #000; border: none; padding: 15px; font-weight: bold; cursor: pointer; border-radius: 5px; }

        /* Стили виджета */
        .preview { flex-grow: 1; display: flex; align-items: center; justify-content: center; background: #0d0d0d; }
        .widget-box { background: #151515; padding: 30px; border-radius: 20px; text-align: center; width: 400px; }

        /* МАГИЯ НАПОЛНЕНИЯ */
        .pig-frame { 
            position: relative; 
            width: 280px; height: 200px; 
            margin: 0 auto 20px;
        }

        .sand-body {
            position: absolute;
            bottom: 0; left: 0; width: 100%; height: 0%;
            background: var(--sand-color);
            /* Трафарет: песок принимает форму картинки */
            -webkit-mask-image: var(--pig-url);
            mask-image: var(--pig-url);
            -webkit-mask-size: contain;
            -webkit-mask-repeat: no-repeat;
            -webkit-mask-position: bottom;
            transition: height 1s ease-in-out;
            z-index: 1;
        }

        .pig-glass {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            object-fit: contain;
            z-index: 2; /* Стекло поверх песка */
            pointer-events: none;
        }

        .score-num { font-size: 48px; color: #ffcc00; font-weight: bold; }
        .btn-grid { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .game-btn { border: 2px solid #ffcc00; background: none; color: #ffcc00; padding: 10px 20px; border-radius: 10px; cursor: pointer; }
    </style>
</head>
<body>

<div class="editor">
    <h3>⚙️ Настройка</h3>
    <label>URL PNG (прозрачный фон)</label>
    <input type="text" id="url" value="https://i.ibb.co/pX99S99/glass-pig.png">
    
    <label>Вопрос | Варианты | Верный</label>
    <textarea id="data">Emil ... Sport|hat gemacht, ist gemacht|0</textarea>
    
    <label>Ставки</label>
    <input type="text" id="bets" value="10, 25, 50">

    <button class="btn-build" onclick="rebuild()">ОБНОВИТЬ</button>
</div>

<div class="preview">
    <div class="widget-box">
        <div class="pig-frame" id="v-frame" style="--pig-url: url('https://i.ibb.co/pX99S99/glass-pig.png')">
            <div id="v-sand" class="sand-body"></div>
            <img id="v-img" class="pig-glass" src="https://i.ibb.co/pX99S99/glass-pig.png">
        </div>
        <div class="score-num" id="v-score">0</div>
        <div id="v-q">Текст вопроса</div>
        <div class="btn-grid" id="v-btns"></div>
    </div>
</div>

<script>
    let score = 0;
    function rebuild() {
        const img = document.getElementById('url').value;
        const [q, opts, cor] = document.getElementById('data').value.split('|');
        const bts = document.getElementById('bets').value.split(',');

        document.getElementById('v-img').src = img;
        document.getElementById('v-frame').style.setProperty('--pig-url', `url('${img}')`);
        document.getElementById('v-q').innerText = q;
        
        const bBox = document.getElementById('v-btns');
        bBox.innerHTML = '';
        bts.forEach(v => {
            const b = document.createElement('button');
            b.className = 'game-btn';
            b.innerText = v.trim();
            b.onclick = () => { score += parseInt(v); update(); };
            bBox.appendChild(b);
        });
        score = 0; update();
    }

    function update() {
        document.getElementById('v-score').innerText = score;
        let h = Math.min(100, (score / 200) * 100);
        document.getElementById('v-sand').style.height = h + '%';
    }
    rebuild();
</script>
</body>
</html>
